---
title: "Introduction to the `better` package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{better}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r, include = FALSE}
# Set all better options to NULL
for (i in stringr::str_subset(names(options()),"better\\.")) {
  print(i)
  print(.Options[[i]])
  .Options[[i]] <- NULL
  print(.Options[[i]])
}
options(
  rmarkdown.html_vignette.check_title = FALSE
  # ,
  # better.gbd_path = NULL #"/Users/jwl38/Library/CloudStorage/GoogleDrive-janwillem.lindemans@gmail.com/My\ Drive/Offline\ Drive/R\ -\ Offline\ Drive/R\ packages\ JW/better/ignore/Global\ Burden\ of\ Disease\ Study\ Data"
  )
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 8, fig.asp = 0.618, # https://r4ds.had.co.nz/graphics-for-communication.html
  out.width = "90%", fig.align = "center"
)
#devtools::build_rmd("vignettes/gbd.Rmd")
```

## Introduction

<!-- ORIGINAL description -->

The `better` package helps you guesstimate the effect of health nudges, that is, behavioral interventions targeted at health behaviors. With `better` guesstimates, you can make the world a `better` place! In addition to guesstimating effect sizes, `better` also helps you guesstimate sample sizes for properly powered studies on health nudges. Finally, `better` also gives guesstimates of how much money you would save in terms of health care.

<!-- end description -->

To make data-driven guesstimates, `better` uses the [Global Burden of Disease (GBD) dataset](https://www.healthdata.org/gbd/2019), an incredibly rich dataset created and maintained by the [Institute for Health Metrics and Evaluation](https://www.healthdata.org/) at the University of Washington, and property of the University of Washington. 

## An example: A diet-related nudge for diabetics

<!-- ORIGINAL HERE - COPY PASTE it to elsewhere -->

```{r, include = FALSE}
library(better)
library(tidyverse)
gbd_filter()
#stop("gbd rows: ",nrow(gbd))
# So that the once-per-session messages are gone:
nudge("information") %>% 
  disease("diabetes mellitus")
```

The main purpose of `better` is to help you better guesstimate the effect of health nudges, that is, behavioral interventions targeted at health behaviors. 

Imagine you are designing a public health campaign. You are thinking about focusing on diabetics, and you are considering making information about healthy foods more accessible. What effects can you expect from a campaign like that? 

This is how we would make a guesstimate with `better`. Let's load it, and let's also load `tidyverse`, so we can use pipes and other tidy constructions.

```{r}
library(better)
library(tidyverse)

nudge("information", behavior = "food") %>% 
  disease("diabetes mellitus") %>%
  describe
```

Note that "DALYs" are *disability-adjusted life years*, a measure of overall disease burden, expressed as the number of years lost due to disease, disability or early death. The output above shows DALYs *saved* by the nudge, that is, the number of years *saved* due to *decreased* disease, disability and death.

As for the code: We basically told `nudge()` what kind of nudge we are envisioning, `"information"`, and what kind of behavior we are targeting: `"food"`-related behavior. We piped the result into `disease()` and told it what disease we are targeting: `"diabetes mellitus"`. Finally, `describe()` simplified the output to a brief description of the guesstimate, which is what you saw.

What if we don't really know what we want to focus on? We can compare effects:

```{r}
compare_effects() # location = "United States of America"
```

So, we got our guesstimate in terms of DALYs saved. There's many other measures we can get estimates for. Let's see how many *years lived with disability* or "YLDs" our nudge would save:

```{r}
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "YLDs") %>%
  describe
```

The reason why I picked YLDs is because it allows us to guesstimate the cost of healthcare saved by the nudge. We do that as follows, with `cost()`:

```{r}
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "YLDs") %>%
  cost %>%
  describe
```

Note that cost calculation is still a feature in development: for now it doesn't yet distinguish between the costs of different diseases. Run `?cost` to read more. 

Once we have the cost savings, we can also guesstimate the *net* savings in cost, that is, the savings from reduce healthcare costs minus the cost of the nudge, of running the campaign. We use the `net()` function:

```{r}
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "YLDs") %>%
  cost %>%
  net %>%
  describe
```

Next, say you are in charge of a campaign at an insurance company with 350,000 members. You can also calculate the net savings for 350,000 members, with the `per()` function:

```{r}
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "YLDs") %>%
  cost %>%
  net %>%
  per(350000) %>%
  describe
```

Finally, say you are considering running an experiment with your members, to see if your nudge has a positive impact. You can do quick power calculations with `sample_size()`. Here is how to do a power calculation for an experiment that wants to detect an impact on food-related behaviors.

```{r}
nudge("information", behavior = "food") %>%
  describe
nudge("information", behavior = "food") %>%
  sample_size
```

Here is how to do a power calculation for a much more ambitious experiment that wants to detect on impact on saving lives (preventing deaths):

```{r}
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "deaths") %>%
  describe
nudge("information", behavior = "food") %>%
  disease("diabetes mellitus", measure = "deaths") %>%
  sample_size
```

The low number of yearly deaths means you'll need a huge sample size! Better just look at behavior change!

Alright, that's a quick overview of what `better` can do for you!

## Complicate things

We could have picked another disease: 
```{r}
nudge("information", behavior = "food") %>% 
  disease("diabetes mellitus") %>%
  describe
```


You get some rich output, but the main thing is the number below "Value": `r nudge("information", behavior = "food") %>% disease("diabetes mellitus") %>% {round(.$value)} %>% format(big.mark = ",")` DALYs. What does it mean? If we're going to roll out an information nudge in 100,000 people, targeted at diabetes mellitus, we're expected to boost disability adjusted life years by about `r nudge("information", behavior = "food") %>% disease("diabetes mellitus") %>% {round(.$value)} %>% format(big.mark = ",")` years. Note that DALYs (disability adjusted life years) refers to healthy life years - life years without disease or disability.

Now, to get the estimate, we called two functions: `nudge()` and `disease()`. That's because we first guesstimate the effect of the nudge on behavior, and then we guesstimate the effect of behavior on disease (DALYs). You can check out the effect of the nudge on behavior by only calling the first function:

```{r}
nudge("information")
```

The philosophy of `better` is to create pipes of guesstimate functions, like `nudge()` and `disease()`, to get a more complicated guesstimate consisting of multiple steps. We can get the full explanation of the guesstimate with `better::explanation()`:

```{r}
nudge("information") %>% 
  disease("cardiovascular diseases") %>%
  explanation
```

This output also shows you that there was an intermediate step in the calculation.

Let's see what happens if we would shift the focus of our intervention to diabetes mellitus. To simplify the output, I use `better::effect_only`. It prints only the effect, leaving out the parameters and explanation.

```{r}
nudge("information") %>%
  disease("diabetes mellitus") %>%
  effect_only
```

What if we tried a structural nudge?

```{r}
nudge("structure") %>%
  disease("diabetes mellitus") %>%
  effect_only
```

What if we wanted to see the impact on deaths?

```{r}
nudge("structure") %>%
  disease("diabetes mellitus", measure = "deaths") %>%
  effect_only
```

You can also get quick power calculations. Say you want to run an experiment, testing the information nudge, with two conditions: a treatment, and a control. You hypothesize the nudge will decrease risky behaviors. How many observations do you need in each condition?

```{r}
nudge("information") %>% 
  sample_size
```
```{r, include = FALSE}
pcalc <- nudge("information") %>% 
  sample_size
```

So, you need about `r round(pcalc$n) %>% format(big.mark = ",")` observations per condition. You may recognize this kind of output. It's the output of `pwr.t.test()` from the `pwr` package, because `sample_size()` wraps that function.

Alternatively, you may want to be sufficiently powered to discern an impact on health - say on the death rate. 

```{r, include = FALSE}
nudge("information") %>%
  disease("cardiovascular diseases", measure = "deaths") %>%
  sample_size
```

Of course you need a much larger sample to be able to detect a difference in mortality.

What if we don't really know what we want to focus on? We can compare effects:

```{r}
compare_effects(location = "United States of America", cause = "diabetes mellitus")
```

You can also run it without any constraints:

```{r}
compare_effects()
```

<!-- END ORIGINAL -->

## Input your own effect size

Imagine you are still designing that public health campaign, on preventing cardiovascular diseases. But suppose you know the effect of your intervention on behavior (or you know the effect you want, etc.). More specifically, you have a Cohen's *d*. Then, `better::behavior_d` allows you to create an effect out of that, in the following way:

```{r}
behavior_d(.56) %>%
  disease("cardiovascular diseases") %>%
  effect_only
```

Rather than manually entering one effect size, you may also want to create your own `better`-style functions. Here's an example:

```{r}
d_categorical <- function(size) {
  if (size == "small") {
    d <- .2
  } else if (size == "medium") {
    d <- .5
  } else if (size == "large") {
    d <- .8
  }
  behavior_d(d, d, d)
}
d_categorical("large")
d_categorical("large") %>%
  disease("cardiovascular diseases") %>%
  effect_only
```

You can also enter a percentage difference (decrease in the risky behavior) with `better::behavior_pct`. Say you know it decreases risky behavior by 11.4%:

```{r}
behavior_pct(11.4) %>%
  disease("cardiovascular diseases") %>%
  effect_only
```

Entering a percentage difference is probably not so useful. The main reason is that inputting a percentage difference makes less assumptions than inputting a Cohen's *d*. We can see why when we split up the calculation in it's steps.

If you start from Cohen's *d*, the calculation is in three steps, because Cohen's *d* needs to be translated in a percentage difference:

```{r}
behavior_d(.56) %>%
  behavior_d_to_pct %>%
  behavior_pct_to_disease("cardiovascular diseases") %>%
  effect_only
```

In contrast, if you start from a percentage difference, it's only two steps: 

```{r}
behavior_pct(11.4) %>%
  behavior_pct_to_disease("cardiovascular diseases") %>%
  effect_only
```

## Breaking things up

Earlier on we looked at this very simple example of an impact guesstimate:

```{r}
nudge("information") %>% 
  disease("cardiovascular diseases") %>%
  effect_only
```

Here is the full reasoning behind it:

First, we look up the effect of an information nudge on health behavior. Note that, rather than `nudge()`, I'm using `nudge_to_behavior_d()` here. It's an alias with different defaults. But it's more explicit, and that's what we want now.

```{r}
nudge_to_behavior_d(nudge = "information", behavior = "health") %>%
  effect_only
```

This gives us a Cohen's *d*, a standardized effect size for the health information nudge, namely, *d* = `r nudge_to_behavior_d(nudge = "information", behavior = "health")$value`.

Second, we translate Cohen's *d* into an odds ratio.

```{r}
step2 <- nudge_to_behavior_d(nudge = "information", behavior = "health") %>%
  d_to_OR %>%
  effect_only
```

Let's look at the explanation:

```{r}
step2 %>%
  explanation(full = FALSE)
```

Third, we convert the odds ratio into a percentage difference, because that's how we can link it to the Global Burden of Disease dataset.

```{r}
step3 <- nudge_to_behavior_d(nudge = "information", behavior = "health") %>%
  d_to_OR %>%
  behavior_OR_to_pct %>%
  effect_only
```

Let's look at the explanation:

```{r}
step3 %>%
  explanation(full = FALSE)
```

Finally, we can get our guesstimate of the effect:

```{r}
step4 <- nudge_to_behavior_d(nudge = "information", behavior = "health") %>%
  d_to_OR %>%
  behavior_OR_to_pct %>%
  behavior_pct_to_disease("cardiovascular diseases") %>%
  effect_only
```

Let's look at the explanation:

```{r}
step4 %>%
  explanation(full = FALSE)
```


We learned something! If we're going to roll out an information nudge in 100,000 people, targeted at cardiovascular diseases, we're expected to boost disability adjusted life years by about `r step4 %>% {round(.$value)}` years! That's not bad. 

Note that this is based on the following statistic:

```{r}
gbd_describe(cause = "cardiovascular diseases")
```


To organize:

```{r}
gbd_cb <- gbd_codebook()
nudge_cb <- nudge_codebook()
nudge_cb$nudge
nudge_cb$behavior
```

## Using different guesstimate methods

To convert the Cohen's *d* into a percentage decrease, by default, `disease()` uses the method from Hasselblad and Hedges (1995) to convert *d* into an odds ratio:

```{r}
nudge("information") %>% 
  disease("cardiovascular diseases") %>%
  effect_only
# same:
nudge("information") %>% 
  disease("cardiovascular diseases", method = "Hasselblad and Hedges") %>%
  effect_only
```

We can also use an alternative method, based on the fact that Cohen's *d* is a difference *in standard deviations*. 

```{r}
nudge("information") %>% 
  disease("cardiovascular diseases", method = "standard deviations") %>%
  effect_only
```

Let's walk through what happens behind the scene when `disease(method = "standard deviations)` does it's magic. The input is of course again a Cohen's *d*:

```{r}
nudge("information") %>%
  effect_only
```

Then, as an intermediate step, it translates Cohen's *d* into a percentage difference, because that's how we can link it to the Global Burden of Disease dataset.

```{r}
eff <- nudge("information") %>%
  behavior_d_to_pct %>%
  effect_only 
```
This gives us a decrease of `r nudge_to_behavior_d(nudge = "information", behavior = "health") %>% behavior_d_to_pct %>% {round(abs(.$value)*100,1)}` percent. Let's look at the explanation:

```{r}
eff %>%
  explanation(full = FALSE)
```

The last step is the same. We can get our guesstimate of the effect with `behavior_pct_to_disease()`:

```{r}
nudge_to_behavior_d(nudge = "information", behavior = "health") %>%
  behavior_d_to_pct %>%
  behavior_pct_to_disease("cardiovascular diseases") %>%
  effect_only
```

## Effect of nudges

Get the effect size for behavioral interventions aka *nudges* with `better::nudge_to_behavior_d`. This returns an object of the `better_effect` class. It's basically a list containing the effect size, the confidence interval, and some other metadata. It's printed in a useful way.

```{r}
eff <- nudge_to_behavior_d()
eff
class(eff)
str(eff)
eff$value
```

Get the full explanation with `better::explanation`.

```{r}
eff %>%
  explanation
```

The estimate above averaged over all categories of behaviors and nudges. Let's now look at the impact for specific categories of behaviors and nudges:

```{r}
nudge_to_behavior_d(behavior = "health")
nudge_to_behavior_d(behavior = "food")
nudge_to_behavior_d(nudge = "assistance")
nudge_to_behavior_d(nudge = "structure")
nudge_to_behavior_d(behavior = "food", nudge = "structure")
nudge_to_behavior_d(behavior = "health", nudge = "information")
```

You can also access the dataset of Cohen's *d*'s.

```{r}
nudge_data()
```

Proportions

```{r}
nudge_to_behavior_d(behavior = "health", nudge = "information") %>%
  print %>%
  behavior_d_to_pct(cause = "cardiovascular diseases") 
nudge_to_behavior_d(behavior = "health", nudge = "information") %>%
  behavior_d_to_pct(cause = "cardiovascular diseases") %>% 
  explanation
```

The estimates of the proportions are based on the GBD data on summary exposure values, which you can access like this:

```{r}
gbd_filter(measure = "summary exposure value")
```


```{r}
# nudge_to_behavior_d("information") %>% print %>%
#   behavior_d_to_pct %>% print %>%
#   behavior_pct_to_disease("cardiovascular disease")
# 
# nudge("information") %>%
#   disease("cardiovascular disease") %>%
#   explanation
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

## Browse categories and download more data

You can browse more causes and risk factors in the full dataset on the website. If you see anything of interest, you can go download the data. `better` has functions that help you browse the codebook for all available causes and risk factors. 

```{r, eval = FALSE, echo = FALSE}
# for browsing, enter 2 and then q
gbd_browse()
# copy output on clipboard
capture(cat(clipboard()),collapse="\n#> ")
# de newlines at user input
```
```{r, eval = FALSE}
gbd_browse_cause()
#> Category:
#> # A tibble: 1 × 9
#>   cause_id cause_name parent_id parent_name level cause_outline sort_order yll_only yld_only
#>      <dbl> <chr>          <dbl> <chr>       <dbl> <chr>              <dbl> <chr>    <chr>   
#> 1      294 All causes       294 All causes      0 Total                  1 NA       NA      
#> 
#> Data already downloaded for this parent category:
#> # A tibble: 1,392 × 19
#>   cause      rei    metric     val measure     upper   lower locat…¹ sex   age    year measu…² locat…³ sex_id age_id cause…⁴
#>   <chr>      <chr>  <chr>    <dbl> <chr>   <dbl>   <dbl> <chr>   <chr> <chr> <dbl>   <dbl>   <dbl>  <dbl>  <dbl>   <dbl>
#> 1 All causes Heari… Number 1.20e+6 YLDs  1.71e+6 8.27e+5 United… Male  All …  2019       3     102      1     22     294
#> 2 All causes Heari… Number 1.03e+6 YLDs  1.42e+6 7.25e+5 United… Fema… All …  2019       3     102      2     22     294
#> 3 All causes Heari… Number 2.24e+6 YLDs  3.11e+6 1.56e+6 United… Both  All …  2019       3     102      3     22     294
#> 4 All causes Heari… Perce… 4.22e-2 YLDs  5.55e-2 3.24e-2 United… Male  All …  2019       3     102      1     22     294
#> 5 All causes Heari… Perce… 3.02e-2 YLDs  3.88e-2 2.36e-2 United… Fema… All …  2019       3     102      2     22     294
#> # … with 1,387 more rows, 3 more variables: rei_id <dbl>, metric_id <dbl>, measure <chr>, and abbreviated variable
#> #   names ¹​location, ²​measure_id, ³​location_id, ⁴​cause_id
#> # ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#> # A tibble: 7 × 9
#>   cause_id cause_name                                              paren…¹ paren…² level cause…³ sort_…⁴ yll_o…⁵ yld_o…⁶
#>      <dbl> <chr>                                                     <dbl> <chr>   <dbl> <chr>     <dbl> <chr>   <chr>  
#> 1      295 Communicable, maternal, neonatal, and nutritional dise…     294 All ca…     1 A             2 NA      NA     
#> 2      409 Non-communicable diseases                                   294 All ca…     1 B            96 NA      NA     
#> 3      687 Injuries                                                    294 All ca…     1 C           320 NA      NA     
#> 4     1029 Total cancers                                               294 All ca…     1 D           361 NA      NA     
#> 5     1026 Total burden related to hepatitis B                         294 All ca…     1 E           362 NA      NA     
#> 6     1027 Total burden related to hepatitis C                         294 All ca…     1 F           363 NA      NA     
#> 7     1028 Total burden related to Non-alcoholic fatty liver dise…     294 All ca…     1 G           364 NA      NA     
#> # … with abbreviated variable names ¹​parent_id, ²​parent_name, ³​cause_outline, ⁴​sort_order, ⁵​yll_only, ⁶​yld_only
#>  
#> Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quit
#>   
#>   2
#>   
#> Category:
#> # A tibble: 1 × 9
#>   cause_id cause_name                parent_id parent_name level cause_outline sort_order yll_only yld_only
#>      <dbl> <chr>                         <dbl> <chr>       <dbl> <chr>              <dbl> <chr>    <chr>   
#> 1      409 Non-communicable diseases       294 All causes      1 B                     96 NA       NA      
#> 
#> Data already downloaded for this parent category:
#>   No data downloaded for this category.
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#> # A tibble: 12 × 9
#>    cause_id cause_name                      parent_id parent_name               level cause_ou…¹ sort_…² yll_o…³ yld_o…⁴
#>       <dbl> <chr>                               <dbl> <chr>                     <dbl> <chr>        <dbl> <chr>   <chr>  
#>  1      410 Neoplasms                             409 Non-communicable diseases     2 B.1             97 NA      NA     
#>  2      491 cardiovascular diseases               409 Non-communicable diseases     2 B.2            144 NA      NA     
#>  3      508 Chronic respiratory diseases          409 Non-communicable diseases     2 B.3            165 NA      NA     
#>  4      526 Digestive diseases                    409 Non-communicable diseases     2 B.4            175 NA      NA     
#>  5      542 Neurological disorders                409 Non-communicable diseases     2 B.5            194 NA      NA     
#>  6      558 Mental disorders                      409 Non-communicable diseases     2 B.6            204 NA      NA     
#>  7      973 Substance use disorders               409 Non-communicable diseases     2 B.7            219 NA      NA     
#>  8      974 Diabetes and kidney diseases          409 Non-communicable diseases     2 B.8            227 NA      NA     
#>  9      653 Skin and subcutaneous diseases        409 Non-communicable diseases     2 B.9            238 NA      NA     
#> 10      669 Sense organ diseases                  409 Non-communicable diseases     2 B.10           256 NA      X      
#> 11      626 Musculoskeletal disorders             409 Non-communicable diseases     2 B.11           266 NA      NA     
#> 12      640 Other non-communicable diseases       409 Non-communicable diseases     2 B.12           277 NA      NA     
#> # … with abbreviated variable names ¹​cause_outline, ²​sort_order, ³​yll_only, ⁴​yld_only
#>  
#> Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quit
#>   
#>   q
#> 
#> Returning last category chosen...
#> [1] "Non-communicable diseases"
```

Now pick risk factors, etiologies, and impairments - called `rei` in GBD-speak - by entering `r`:

```{r, eval = FALSE, echo = FALSE}
# for browsing, enter 2 and then q
gbd_browse()
# copy output on clipboard
capture(cat(clipboard()),collapse="\n#> ")
# de newlines at user input
```
```{r, eval = FALSE}
gbd_browse()
#> Category:
#> 
#> Data already downloaded for this parent category:
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#>  Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quit
#> Category:
#> 
#> Data already downloaded for this parent category:
#>   No data downloaded for this category.
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#>  
#> Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quitq
#> 
#> Returning last category chosen...
#> [1] "Environmental/occupational risks"
#> > gbd_browse_rei(gbd)
#> Category:
#> # A tibble: 1 × 6
#>   rei_id rei_name         parent_id parent_name      level sort_order
#>    <dbl> <chr>                <dbl> <chr>            <dbl>      <dbl>
#> 1    169 all risk factors       169 all risk factors     0          1
#> 
#> Data already downloaded for this parent category:
#> # A tibble: 753 × 19
#>   cause       rei   metric     val measure     upper   lower locat…¹ sex   age    year measu…² locat…³ sex_id age_id cause…⁴
#>   <chr>       <chr> <chr>    <dbl> <chr>   <dbl>   <dbl> <chr>   <chr> <chr> <dbl>   <dbl>   <dbl>  <dbl>  <dbl>   <dbl>
#> 1 All causes  All … Number 3.50e+7 Deat… 3.69e+7 3.29e+7 Global  Both  All …  2019       1       1      3     22     294
#> 2 All causes  All … Perce… 6.19e-1 Deat… 6.38e-1 5.98e-1 Global  Both  All …  2019       1       1      3     22     294
#> 3 All causes  All … Rate   4.52e+2 Deat… 4.77e+2 4.26e+2 Global  Both  All …  2019       1       1      3     22     294
#> 4 Cardiovasc… All … Number 1.60e+7 Deat… 1.70e+7 1.47e+7 Global  Both  All …  2019       1       1      3     22     491
#> 5 Cardiovasc… All … Perce… 8.60e-1 Deat… 8.82e-1 8.37e-1 Global  Both  All …  2019       1       1      3     22     491
#> # … with 748 more rows, 3 more variables: rei_id <dbl>, metric_id <dbl>, measure <chr>, and abbreviated variable names
#> #   ¹​location, ²​measure_id, ³​location_id, ⁴​cause_id
#> # ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#> # A tibble: 3 × 6
#>   rei_id rei_name                         parent_id parent_name      level sort_order
#>    <dbl> <chr>                                <dbl> <chr>            <dbl>      <dbl>
#> 1    202 Environmental/occupational risks       169 all risk factors     1          2
#> 2    203 behavioral risks                       169 all risk factors     1          3
#> 3    104 Metabolic risks                        169 all risk factors     1          4
#>  
#> Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quit
#>   
#>   2
#>   
#> Category:
#> # A tibble: 1 × 6
#>   rei_id rei_name         parent_id parent_name      level sort_order
#>    <dbl> <chr>                <dbl> <chr>            <dbl>      <dbl>
#> 1    203 behavioral risks       169 all risk factors     1          3
#> 
#> Data already downloaded for this parent category:
#> # A tibble: 381 × 19
#>   cause       rei   metric     val measure     upper   lower locat…¹ sex   age    year measu…² locat…³ sex_id age_id cause…⁴
#>   <chr>       <chr> <chr>    <dbl> <chr>   <dbl>   <dbl> <chr>   <chr> <chr> <dbl>   <dbl>   <dbl>  <dbl>  <dbl>   <dbl>
#> 1 All causes  Beha… Number 2.16e+7 Deat… 2.34e+7 2.00e+7 Global  Both  All …  2019       1       1      3     22     294
#> 2 All causes  Beha… Perce… 3.82e-1 Deat… 4.08e-1 3.61e-1 Global  Both  All …  2019       1       1      3     22     294
#> 3 All causes  Beha… Rate   2.79e+2 Deat… 3.03e+2 2.59e+2 Global  Both  All …  2019       1       1      3     22     294
#> 4 Cardiovasc… Beha… Number 9.16e+6 Deat… 1.05e+7 8.06e+6 Global  Both  All …  2019       1       1      3     22     491
#> 5 Cardiovasc… Beha… Perce… 4.93e-1 Deat… 5.50e-1 4.43e-1 Global  Both  All …  2019       1       1      3     22     491
#> # … with 376 more rows, 3 more variables: rei_id <dbl>, metric_id <dbl>, measure <chr>, and abbreviated variable names
#> #   ¹​location, ²​measure_id, ³​location_id, ⁴​cause_id
#> # ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names
#> If you want to download more data, you can quit and run: gbd_download()
#> 
#> Subcategories:
#> # A tibble: 9 × 6
#>   rei_id rei_name                            parent_id parent_name      level sort_order
#>    <dbl> <chr>                                   <dbl> <chr>            <dbl>      <dbl>
#> 1     92 Child and maternal malnutrition           203 behavioral risks     2         43
#> 2     98 Tobacco                                   203 behavioral risks     2         57
#> 3    102 Alcohol use                               203 behavioral risks     2         61
#> 4    103 Drug use                                  203 behavioral risks     2         62
#> 5    110 Dietary risks                             203 behavioral risks     2         63
#> 6    135 Intimate partner violence                 203 behavioral risks     2         78
#> 7    381 Childhood sexual abuse and bullying       203 behavioral risks     2         79
#> 8    170 Unsafe sex                                203 behavioral risks     2         82
#> 9    125 Low physical activity                     203 behavioral risks     2         83
#>  
#> Enter row nr of category to browse and hit return: 
#>   Other options:
#>   - Hit return without input to pick first row;
#>   - Enter search term;
#>   - Enter 'b' to go back;
#>   - Enter 'q' to quit
#>   
#>   q
#> 
#> Returning last category chosen...
#> [1] "behavioral risks"
```

Once you have found what you want data on, the browsers show you whether you already have data on it.
If you don't, you have to go download it. `better::gbd_download()` will open the website where you can download it for you. It also opens some other useful pages, as well as your GBD folder, where you'll want to store the data.

```{r, eval = FALSE}
gbd_download()
```

You can also print tree diagrams of the causes and REIs, as follows:

```{r, eval = FALSE}
gbd_causes() %>% tree
# \1: all causes
#   \1.1: Communicable, maternal, neonatal, and nutritional diseases
#     \1.1.1: HIV/AIDS and sexually transmitted infections
#       \1.1.1.1: HIV/AIDS
#         \1.1.1.1.1: HIV/AIDS - drug-susceptible tuberculosis
#         \1.1.1.1.2: HIV/AIDS - multidrug-resistant tuberculosis without extensive drug resistance
#         \1.1.1.1.3: HIV/AIDS - extensively drug-resistant tuberculosis
#         \1.1.1.1.4: HIV/AIDS resulting in other diseases
#       \1.1.1.2: sexually transmitted infections excluding HIV
#         \1.1.1.2.1: syphilis
#         \1.1.1.2.2: chlamydial infection
#         \1.1.1.2.3: gonococcal infection
#         \1.1.1.2.4: trichomoniasis
#         \1.1.1.2.5: genital herpes
#         \1.1.1.2.6: other sexually transmitted infections
#     \1.1.2: respiratory infections and tuberculosis
#       \1.1.2.1: tuberculosis
#         \1.1.2.1.1: latent tuberculosis infection
#         \1.1.2.1.2: drug-susceptible tuberculosis
#         \1.1.2.1.3: multidrug-resistant tuberculosis without extensive drug resistance
#         \1.1.2.1.4: extensively drug-resistant tuberculosis
#       \1.1.2.2: lower respiratory infections
#       \1.1.2.3: upper respiratory infections
#       \1.1.2.4: otitis media
#     \1.1.3: enteric infections
#       \1.1.3.1: diarrheal diseases
#       \1.1.3.2: typhoid and paratyphoid
#         \1.1.3.2.1: typhoid fever
#         \1.1.3.2.2: paratyphoid fever
#       \1.1.3.3: invasive non-typhoidal salmonella (iNTS)
#       \1.1.3.4: other intestinal infectious diseases
#     \1.1.4: neglected tropical diseases and malaria
#       \1.1.4.1: malaria
#       \1.1.4.2: chagas disease
#       \1.1.4.3: leishmaniasis
#         \1.1.4.3.1: visceral leishmaniasis
#         \1.1.4.3.2: cutaneous and mucocutaneous leishmaniasis
#       \1.1.4.4: african trypanosomiasis
#       \1.1.4.5: schistosomiasis
#       \1.1.4.6: cysticercosis
#       \1.1.4.7: cystic echinococcosis
#       \1.1.4.8: lymphatic filariasis
#       \1.1.4.9: onchocerciasis
#       \1.1.4.10: trachoma
#       \1.1.4.11: dengue
#       \1.1.4.12: yellow fever
#       \1.1.4.13: rabies
#       \1.1.4.14: intestinal nematode infections
#         \1.1.4.14.1: ascariasis
#         \1.1.4.14.2: trichuriasis
#         \1.1.4.14.3: hookworm disease
#       \1.1.4.15: food-borne trematodiases
#       \1.1.4.16: leprosy
#       \1.1.4.17: ebola
#       \1.1.4.18: zika virus
#       \1.1.4.19: guinea worm disease
#       \1.1.4.20: other neglected tropical diseases
#     \1.1.5: other infectious diseases
#       \1.1.5.1: meningitis
#       \1.1.5.2: encephalitis
#       \1.1.5.3: diphtheria
#       \1.1.5.4: whooping cough
#       \1.1.5.5: tetanus
#       \1.1.5.6: measles
#       \1.1.5.7: varicella and herpes zoster
#       \1.1.5.8: acute hepatitis
#         \1.1.5.8.1: acute hepatitis A
#         \1.1.5.8.2: acute hepatitis B
#         \1.1.5.8.3: acute hepatitis C
#         \1.1.5.8.4: acute hepatitis E
#       \1.1.5.9: other unspecified infectious diseases
#     \1.1.6: maternal and neonatal disorders
#       \1.1.6.1: maternal disorders
#         \1.1.6.1.1: maternal hemorrhage
#         \1.1.6.1.2: maternal sepsis and other maternal infections
#         \1.1.6.1.3: maternal hypertensive disorders
#         \1.1.6.1.4: maternal obstructed labor and uterine rupture
#         \1.1.6.1.5: maternal abortion and miscarriage
#         \1.1.6.1.6: ectopic pregnancy
#         \1.1.6.1.7: indirect maternal deaths
#         \1.1.6.1.8: late maternal deaths
#         \1.1.6.1.9: maternal deaths aggravated by HIV/AIDS
#         \1.1.6.1.10: other maternal disorders
#       \1.1.6.2: neonatal disorders
#         \1.1.6.2.1: neonatal preterm birth
#         \1.1.6.2.2: neonatal encephalopathy due to birth asphyxia and trauma
#         \1.1.6.2.3: neonatal sepsis and other neonatal infections
#         \1.1.6.2.4: hemolytic disease and other neonatal jaundice
#         \1.1.6.2.5: other neonatal disorders
#     \1.1.7: nutritional deficiencies
#       \1.1.7.1: protein-energy malnutrition
#       \1.1.7.2: iodine deficiency
#       \1.1.7.3: vitamin A deficiency
#       \1.1.7.4: dietary iron deficiency
#       \1.1.7.5: other nutritional deficiencies
#   \1.2: non-communicable diseases
#     \1.2.1: neoplasms
#       \1.2.1.1: lip and oral cavity cancer
#       \1.2.1.2: nasopharynx cancer
#       \1.2.1.3: other pharynx cancer
#       \1.2.1.4: esophageal cancer
#       \1.2.1.5: stomach cancer
#       \1.2.1.6: colon and rectum cancer
#       \1.2.1.7: liver cancer
#         \1.2.1.7.1: liver cancer due to hepatitis B
#         \1.2.1.7.2: liver cancer due to hepatitis C
#         \1.2.1.7.3: liver cancer due to alcohol use
#         \1.2.1.7.4: liver cancer due to NASH
#         \1.2.1.7.5: liver cancer due to other causes
#       \1.2.1.8: gallbladder and biliary tract cancer
#       \1.2.1.9: pancreatic cancer
#       \1.2.1.10: larynx cancer
#       \1.2.1.11: Tracheal, bronchus, and lung cancer
#       \1.2.1.12: malignant skin melanoma
#       \1.2.1.13: non-melanoma skin cancer
#         \1.2.1.13.1: non-melanoma skin cancer (squamous-cell carcinoma)
#         \1.2.1.13.2: non-melanoma skin cancer (basal-cell carcinoma)
#       \1.2.1.14: breast cancer
#       \1.2.1.15: cervical cancer
#       \1.2.1.16: uterine cancer
#       \1.2.1.17: ovarian cancer
#       \1.2.1.18: prostate cancer
#       \1.2.1.19: testicular cancer
#       \1.2.1.20: kidney cancer
#       \1.2.1.21: bladder cancer
#       \1.2.1.22: brain and central nervous system cancer
#       \1.2.1.23: thyroid cancer
#       \1.2.1.24: mesothelioma
#       \1.2.1.25: hodgkin lymphoma
#       \1.2.1.26: Non-Hodgkin lymphoma
#       \1.2.1.27: multiple myeloma
#       \1.2.1.28: leukemia
#         \1.2.1.28.1: acute lymphoid leukemia
#         \1.2.1.28.2: chronic lymphoid leukemia
#         \1.2.1.28.3: acute myeloid leukemia
#         \1.2.1.28.4: chronic myeloid leukemia
#         \1.2.1.28.5: other leukemia
#       \1.2.1.29: other malignant neoplasms
#       \1.2.1.30: other neoplasms
#         \1.2.1.30.1: Myelodysplastic, myeloproliferative, and other hematopoietic neoplasms
#         \1.2.1.30.2: benign and in situ intestinal neoplasms
#         \1.2.1.30.3: benign and in situ cervical and uterine neoplasms
#         \1.2.1.30.4: other benign and in situ neoplasms
#     \1.2.2: cardiovascular diseases
#       \1.2.2.1: rheumatic heart disease
#       \1.2.2.2: ischemic heart disease
#       \1.2.2.3: stroke
#         \1.2.2.3.1: ischemic stroke
#         \1.2.2.3.2: intracerebral hemorrhage
#         \1.2.2.3.3: subarachnoid hemorrhage
#       \1.2.2.4: hypertensive heart disease
#       \1.2.2.5: non-rheumatic valvular heart disease
#         \1.2.2.5.1: non-rheumatic calcific aortic valve disease
#         \1.2.2.5.2: non-rheumatic degenerative mitral valve disease
#         \1.2.2.5.3: other non-rheumatic valve diseases
#       \1.2.2.6: cardiomyopathy and myocarditis
#         \1.2.2.6.1: myocarditis
#         \1.2.2.6.2: alcoholic cardiomyopathy
#         \1.2.2.6.3: other cardiomyopathy
#       \1.2.2.7: atrial fibrillation and flutter
#       \1.2.2.8: aortic aneurysm
#       \1.2.2.9: peripheral artery disease
#       \1.2.2.10: endocarditis
#       \1.2.2.11: other cardiovascular and circulatory diseases
#     \1.2.3: chronic respiratory diseases
#       \1.2.3.1: chronic obstructive pulmonary disease
#       \1.2.3.2: pneumoconiosis
#         \1.2.3.2.1: silicosis
#         \1.2.3.2.2: asbestosis
#         \1.2.3.2.3: coal workers pneumoconiosis
#         \1.2.3.2.4: other pneumoconiosis
#       \1.2.3.3: asthma
#       \1.2.3.4: interstitial lung disease and pulmonary sarcoidosis
#       \1.2.3.5: other chronic respiratory diseases
#     \1.2.4: digestive diseases
#       \1.2.4.1: cirrhosis and other chronic liver diseases
#         \1.2.4.1.1: cirrhosis and other chronic liver diseases due to hepatitis B
#         \1.2.4.1.2: cirrhosis and other chronic liver diseases due to hepatitis C
#         \1.2.4.1.3: cirrhosis and other chronic liver diseases due to alcohol use
#         \1.2.4.1.4: cirrhosis and other chronic liver diseases due to NAFLD
#         \1.2.4.1.5: cirrhosis and other chronic liver diseases due to other causes
#       \1.2.4.2: upper digestive system diseases
#         \1.2.4.2.1: peptic ulcer disease
#         \1.2.4.2.2: gastritis and duodenitis
#         \1.2.4.2.3: gastroesophageal reflux disease
#       \1.2.4.3: appendicitis
#       \1.2.4.4: paralytic ileus and intestinal obstruction
#       \1.2.4.5: Inguinal, femoral, and abdominal hernia
#       \1.2.4.6: inflammatory bowel disease
#       \1.2.4.7: vascular intestinal disorders
#       \1.2.4.8: gallbladder and biliary diseases
#       \1.2.4.9: pancreatitis
#       \1.2.4.10: other digestive diseases
#     \1.2.5: neurological disorders
#       \1.2.5.1: Alzheimer's disease and other dementias
#       \1.2.5.2: Parkinson's disease
#       \1.2.5.3: idiopathic epilepsy
#       \1.2.5.4: multiple sclerosis
#       \1.2.5.5: motor neuron disease
#       \1.2.5.6: headache disorders
#         \1.2.5.6.1: migraine
#         \1.2.5.6.2: tension-type headache
#       \1.2.5.7: other neurological disorders
#     \1.2.6: mental disorders
#       \1.2.6.1: schizophrenia
#       \1.2.6.2: depressive disorders
#         \1.2.6.2.1: major depressive disorder
#         \1.2.6.2.2: dysthymia
#       \1.2.6.3: bipolar disorder
#       \1.2.6.4: anxiety disorders
#       \1.2.6.5: eating disorders
#         \1.2.6.5.1: anorexia nervosa
#         \1.2.6.5.2: bulimia nervosa
#       \1.2.6.6: autism spectrum disorders
#       \1.2.6.7: attention-deficit/hyperactivity disorder
#       \1.2.6.8: conduct disorder
#       \1.2.6.9: idiopathic developmental intellectual disability
#       \1.2.6.10: other mental disorders
#     \1.2.7: substance use disorders
#       \1.2.7.1: alcohol use disorders
#       \1.2.7.2: drug use disorders
#         \1.2.7.2.1: opioid use disorders
#         \1.2.7.2.2: cocaine use disorders
#         \1.2.7.2.3: amphetamine use disorders
#         \1.2.7.2.4: cannabis use disorders
#         \1.2.7.2.5: other drug use disorders
#     \1.2.8: diabetes and kidney diseases
#       \1.2.8.1: diabetes mellitus
#         \1.2.8.1.1: diabetes mellitus type 1
#         \1.2.8.1.2: diabetes mellitus type 2
#       \1.2.8.2: chronic kidney disease
#         \1.2.8.2.1: chronic kidney disease due to diabetes mellitus type 1
#         \1.2.8.2.2: chronic kidney disease due to diabetes mellitus type 2
#         \1.2.8.2.3: chronic kidney disease due to hypertension
#         \1.2.8.2.4: chronic kidney disease due to glomerulonephritis
#         \1.2.8.2.5: chronic kidney disease due to other and unspecified causes
#       \1.2.8.3: acute glomerulonephritis
#     \1.2.9: skin and subcutaneous diseases
#       \1.2.9.1: dermatitis
#         \1.2.9.1.1: atopic dermatitis
#         \1.2.9.1.2: contact dermatitis
#         \1.2.9.1.3: seborrhoeic dermatitis
#       \1.2.9.2: psoriasis
#       \1.2.9.3: bacterial skin diseases
#         \1.2.9.3.1: cellulitis
#         \1.2.9.3.2: pyoderma
#       \1.2.9.4: scabies
#       \1.2.9.5: fungal skin diseases
#       \1.2.9.6: viral skin diseases
#       \1.2.9.7: acne vulgaris
#       \1.2.9.8: alopecia areata
#       \1.2.9.9: pruritus
#       \1.2.9.10: urticaria
#       \1.2.9.11: decubitus ulcer
#       \1.2.9.12: other skin and subcutaneous diseases
#     \1.2.10: sense organ diseases
#       \1.2.10.1: blindness and vision loss
#         \1.2.10.1.1: glaucoma
#         \1.2.10.1.2: cataract
#         \1.2.10.1.3: age-related macular degeneration
#         \1.2.10.1.4: refraction disorders
#         \1.2.10.1.5: near vision loss
#         \1.2.10.1.6: other vision loss
#       \1.2.10.2: age-related and other hearing loss
#       \1.2.10.3: other sense organ diseases
#     \1.2.11: musculoskeletal disorders
#       \1.2.11.1: rheumatoid arthritis
#       \1.2.11.2: osteoarthritis
#         \1.2.11.2.1: osteoarthritis hip
#         \1.2.11.2.2: osteoarthritis knee
#         \1.2.11.2.3: osteoarthritis hand
#         \1.2.11.2.4: osteoarthritis other
#       \1.2.11.3: low back pain
#       \1.2.11.4: neck pain
#       \1.2.11.5: gout
#       \1.2.11.6: other musculoskeletal disorders
#     \1.2.12: other non-communicable diseases
#       \1.2.12.1: congenital birth defects
#         \1.2.12.1.1: neural tube defects
#         \1.2.12.1.2: congenital heart anomalies
#         \1.2.12.1.3: orofacial clefts
#         \1.2.12.1.4: down syndrome
#         \1.2.12.1.5: turner syndrome
#         \1.2.12.1.6: klinefelter syndrome
#         \1.2.12.1.7: other chromosomal abnormalities
#         \1.2.12.1.8: congenital musculoskeletal and limb anomalies
#         \1.2.12.1.9: urogenital congenital anomalies
#         \1.2.12.1.10: digestive congenital anomalies
#         \1.2.12.1.11: other congenital birth defects
#       \1.2.12.2: urinary diseases and male infertility
#         \1.2.12.2.1: urinary tract infections and interstitial nephritis
#         \1.2.12.2.2: urolithiasis
#         \1.2.12.2.3: benign prostatic hyperplasia
#         \1.2.12.2.4: male infertility
#         \1.2.12.2.5: other urinary diseases
#       \1.2.12.3: gynecological diseases
#         \1.2.12.3.1: uterine fibroids
#         \1.2.12.3.2: polycystic ovarian syndrome
#         \1.2.12.3.3: female infertility
#         \1.2.12.3.4: endometriosis
#         \1.2.12.3.5: genital prolapse
#         \1.2.12.3.6: premenstrual syndrome
#         \1.2.12.3.7: other gynecological diseases
#       \1.2.12.4: hemoglobinopathies and hemolytic anemias
#         \1.2.12.4.1: thalassemias
#         \1.2.12.4.2: thalassemias trait
#         \1.2.12.4.3: sickle cell disorders
#         \1.2.12.4.4: sickle cell trait
#         \1.2.12.4.5: G6PD deficiency
#         \1.2.12.4.6: G6PD trait
#         \1.2.12.4.7: other hemoglobinopathies and hemolytic anemias
#       \1.2.12.5: Endocrine, metabolic, blood, and immune disorders
#       \1.2.12.6: oral disorders
#         \1.2.12.6.1: caries of deciduous teeth
#         \1.2.12.6.2: caries of permanent teeth
#         \1.2.12.6.3: periodontal diseases
#         \1.2.12.6.4: edentulism
#         \1.2.12.6.5: other oral disorders
#       \1.2.12.7: sudden infant death syndrome
#   \1.3: injuries
#     \1.3.1: transport injuries
#       \1.3.1.1: road injuries
#         \1.3.1.1.1: pedestrian road injuries
#         \1.3.1.1.2: cyclist road injuries
#         \1.3.1.1.3: motorcyclist road injuries
#         \1.3.1.1.4: motor vehicle road injuries
#         \1.3.1.1.5: other road injuries
#       \1.3.1.2: other transport injuries
#     \1.3.2: unintentional injuries
#       \1.3.2.1: falls
#       \1.3.2.2: drowning
#       \1.3.2.3: Fire, heat, and hot substances
#       \1.3.2.4: poisonings
#         \1.3.2.4.1: poisoning by carbon monoxide
#         \1.3.2.4.2: poisoning by other means
#       \1.3.2.5: exposure to mechanical forces
#         \1.3.2.5.1: unintentional firearm injuries
#         \1.3.2.5.2: other exposure to mechanical forces
#       \1.3.2.6: adverse effects of medical treatment
#       \1.3.2.7: animal contact
#         \1.3.2.7.1: venomous animal contact
#         \1.3.2.7.2: non-venomous animal contact
#       \1.3.2.8: foreign body
#         \1.3.2.8.1: pulmonary aspiration and foreign body in airway
#         \1.3.2.8.2: foreign body in eyes
#         \1.3.2.8.3: foreign body in other body part
#       \1.3.2.9: environmental heat and cold exposure
#       \1.3.2.10: exposure to forces of nature
#       \1.3.2.11: other unintentional injuries
#     \1.3.3: self-harm and interpersonal violence
#       \1.3.3.1: self-harm
#         \1.3.3.1.1: self-harm by firearm
#         \1.3.3.1.2: self-harm by other specified means
#       \1.3.3.2: interpersonal violence
#         \1.3.3.2.1: physical violence by firearm
#         \1.3.3.2.2: physical violence by sharp object
#         \1.3.3.2.3: sexual violence
#         \1.3.3.2.4: physical violence by other means
#       \1.3.3.3: conflict and terrorism
#       \1.3.3.4: executions and police conflict
#   \1.4: total cancers
#   \1.5: total burden related to hepatitis B
#   \1.6: total burden related to hepatitis C
#   \1.7: total burden related to non-alcoholic fatty liver disease (NAFLD)
gbd_reis() %>% tree
# \1: all risk factors
#       \1: high temperature
#   \1.1: environmental/occupational risks
#     \1.1.1: unsafe water, sanitation, and handwashing
#       \1.1.1.1: unsafe water source
#       \1.1.1.2: unsafe sanitation
#       \1.1.1.3: no access to handwashing facility
#     \1.1.2: air pollution
#       \1.1.2.1: particulate matter pollution
#         \1.1.2.1.1: ambient particulate matter pollution
#         \1.1.2.1.2: household air pollution from solid fuels
#       \1.1.2.2: ambient ozone pollution
#     \1.1.3: suboptimal temperature
#     \1.1.4: other environmental risks
#       \1.1.4.1: residential radon
#       \1.1.4.2: lead exposure
#     \1.1.5: occupational risks
#       \1.1.5.1: occupational carcinogens
#         \1.1.5.1.1: occupational exposure to asbestos
#         \1.1.5.1.2: occupational exposure to arsenic
#         \1.1.5.1.3: occupational exposure to benzene
#         \1.1.5.1.4: occupational exposure to beryllium
#         \1.1.5.1.5: occupational exposure to cadmium
#         \1.1.5.1.6: occupational exposure to chromium
#         \1.1.5.1.7: occupational exposure to diesel engine exhaust
#         \1.1.5.1.8: occupational exposure to formaldehyde
#         \1.1.5.1.9: occupational exposure to nickel
#         \1.1.5.1.10: occupational exposure to polycyclic aromatic hydrocarbons
#         \1.1.5.1.11: occupational exposure to silica
#         \1.1.5.1.12: occupational exposure to sulfuric acid
#         \1.1.5.1.13: occupational exposure to trichloroethylene
#       \1.1.5.2: occupational asthmagens
#       \1.1.5.3: occupational particulate matter, gases, and fumes
#       \1.1.5.4: occupational noise
#       \1.1.5.5: occupational injuries
#       \1.1.5.6: occupational ergonomic factors
#   \1.2: behavioral risks
#     \1.2.1: child and maternal malnutrition
#       \1.2.1.1: suboptimal breastfeeding
#         \1.2.1.1.1: non-exclusive breastfeeding
#         \1.2.1.1.2: discontinued breastfeeding
#       \1.2.1.2: child growth failure
#         \1.2.1.2.1: child underweight
#         \1.2.1.2.2: child wasting
#         \1.2.1.2.3: child stunting
#       \1.2.1.3: low birth weight and short gestation
#         \1.2.1.3.1: short gestation
#         \1.2.1.3.2: low birth weight
#       \1.2.1.4: iron deficiency
#       \1.2.1.5: vitamin A deficiency
#       \1.2.1.6: zinc deficiency
#     \1.2.2: tobacco
#       \1.2.2.1: smoking
#       \1.2.2.2: chewing tobacco
#       \1.2.2.3: secondhand smoke
#     \1.2.3: alcohol use
#     \1.2.4: drug use
#     \1.2.5: dietary risks
#       \1.2.5.1: diet low in fruits
#       \1.2.5.2: diet low in vegetables
#       \1.2.5.3: diet low in legumes
#       \1.2.5.4: diet low in whole grains
#       \1.2.5.5: diet low in nuts and seeds
#       \1.2.5.6: diet low in milk
#       \1.2.5.7: diet high in red meat
#       \1.2.5.8: diet high in processed meat
#       \1.2.5.9: diet high in sugar-sweetened beverages
#       \1.2.5.10: diet low in fiber
#       \1.2.5.11: diet low in calcium
#       \1.2.5.12: diet low in seafood omega-3 fatty acids
#       \1.2.5.13: diet low in polyunsaturated fatty acids
#       \1.2.5.14: diet high in trans fatty acids
#       \1.2.5.15: diet high in sodium
#     \1.2.6: intimate partner violence
#     \1.2.7: childhood sexual abuse and bullying
#       \1.2.7.1: childhood sexual abuse
#       \1.2.7.2: bullying victimization
#     \1.2.8: unsafe sex
#     \1.2.9: low physical activity
#   \1.3: metabolic risks
#     \1.3.1: high fasting plasma glucose
#     \1.3.2: high LDL cholesterol
#     \1.3.3: high systolic blood pressure
#     \1.3.4: high body-mass index
#     \1.3.5: low bone mineral density
#     \1.3.6: impaired kidney function
# \2: etiologies
#       \2: low temperature
#   \2.1: cholera
#   \2.2: non-typhoidal salmonella
#   \2.3: shigella
#   \2.4: enteropathogenic E coli
#   \2.5: enterotoxigenic E coli
#   \2.6: campylobacter
#   \2.7: entamoeba
#   \2.8: cryptosporidium
#   \2.9: rotavirus
#   \2.10: aeromonas
#   \2.11: clostridium difficile
#   \2.12: norovirus
#   \2.13: adenovirus
#   \2.14: influenza
#   \2.15: pneumococcus
#   \2.16: H influenzae type B
#   \2.17: respiratory syncytial virus
#   \2.18: meningococcal meningitis
# \3: impairments
#   \3.1: anemia
#     \3.1.1: mild anemia
#     \3.1.2: moderate anemia
#     \3.1.3: severe anemia
#   \3.2: epilepsy
#     \3.2.1: treated epilepsy
#     \3.2.2: moderate epilepsy
#     \3.2.3: severe epilepsy
#   \3.3: Guillain-Barré syndrome
#   \3.4: hearing loss
#     \3.4.1: mild hearing loss
#     \3.4.2: moderate hearing loss
#     \3.4.3: moderately severe hearing loss
#     \3.4.4: severe hearing loss
#     \3.4.5: profound hearing loss
#     \3.4.6: complete hearing loss
#   \3.5: heart failure
#     \3.5.1: mild heart failure
#     \3.5.2: moderate heart failure
#     \3.5.3: severe heart failure
#     \3.5.4: treated heart failure
#   \3.6: infertility
#     \3.6.1: primary infertility
#     \3.6.2: secondary infertility
#   \3.7: developmental intellectual disability
#     \3.7.1: borderline intellectual disability
#     \3.7.2: mild intellectual disability
#     \3.7.3: moderate intellectual disability
#     \3.7.4: severe intellectual disability
#     \3.7.5: profound intellectual disability
#   \3.8: pelvic inflammatory disease
#     \3.8.1: moderate pelvic inflammatory disease
#     \3.8.2: severe pelvic inflammatory disease
#   \3.9: blindness and vision loss
#     \3.9.1: moderate vision loss
#     \3.9.2: severe vision loss
#     \3.9.3: blindness
#     \3.9.4: presbyopia
# \4: injuries
# \5: amputations
#   \5.1: amputation of lower limbs, bilateral
#   \5.2: amputation of upper limbs, bilateral
#   \5.3: amputation of fingers (excluding thumb)
#   \5.4: amputation of lower limb, unilateral
#   \5.5: amputation of upper limb, unilateral
#   \5.6: amputation of thumb
#   \5.7: amputation of toe/toes
# \6: burns
#   \6.1: lower airway burns
#   \6.2: Burns, <20% total burned surface area without lower airway burns
#   \6.3: Burns, >=20% total burned surface area or >= 10% burned surface area if head/neck or hands/wrist involved w/o lower airway burns
# \7: fractures
#   \7.1: fracture of clavicle, scapula, or humerus
#   \7.2: fracture of face bones
#   \7.3: fracture of foot bones except ankle
#   \7.4: fracture of hand (wrist and other distal part of hand)
#   \7.5: fracture of hip
#   \7.6: fracture of patella, tibia or fibula, or ankle
#   \7.7: fracture of pelvis
#   \7.8: fracture of radius and/or ulna
#   \7.9: fracture of skull
#   \7.10: fracture of sternum and/or fracture of one or more ribs
#   \7.11: fracture of vertebral column
#   \7.12: fracture of femur, other than femoral neck
# \8: head injuries
#   \8.1: minor TBI
#   \8.2: Moderate/Severe TBI
# \9: spinal injuries
#   \9.1: spinal cord lesion at neck level
#   \9.2: spinal cord lesion below neck level
# \10: minor injuries
#   \10.1: muscle and tendon injuries, including sprains and strains lesser dislocations
#   \10.2: foreign body in ear
#   \10.3: open wound(s)
#   \10.4: contusion in any part of the body
#   \10.5: superficial injury of any part of the body
# \11: other injuries
#   \11.1: dislocation of hip
#   \11.2: dislocation of knee
#   \11.3: dislocation of shoulder
#   \11.4: foreign body in respiratory system
#   \11.5: foreign body in GI and urogenital system
#   \11.6: drowning and nonfatal submersion
#   \11.7: asphyxiation
#   \11.8: crush injury
#   \11.9: nerve injury
#   \11.10: injury to eyes
#   \11.11: poisoning requiring urgent care
#   \11.12: severe chest injury
#   \11.13: internal hemorrhage in abdomen and pelvis
#   \11.14: effect of different environmental factors
#   \11.15: complications following therapeutic procedures
#   \11.16: multiple fractures, dislocations, crashes, wounds, pains, and strains
```

Let's take a look at some values:

```{r}
gbd_filter(cause = "cardiovascular diseases", rei = NA)
gbd_filter(cause = "cardiovascular diseases", rei = "all risk factors", measure = c("deaths", "DALYs"))
```

## Download more Global Burden of Disease data

This requires some work

Download **GBD data** from the query tool on the Global Health Data Exchange website by the Institute for Health Metrics and Evaluation (IHME). Click [here](https://vizhub.healthdata.org/gbd-results/) to go to the website. 

You'll need to create an account first. Click `Sign in`, then `Register`, etc.  

Then go back to the [GBD Results page](https://vizhub.healthdata.org/gbd-results/). It's a huge database, so you can't download everything. 

Enter whatever parameters you want data on.

Then click `Download`, and, for `Include ID values or names`, pick `Names`. When it says "You can also monitor progress `here`", click `here` and then `Download`.

If you want to download more data, with similar parameters, you're in luck, because the query tool remembers what you entered last times. Go back by clicking the left arrow on top of the page, to the left of `Data Download`. It will take you back to the Search page, where you just entered all these parameters. It should remember all the parameters you inputted last time. Do the previous steps all over again...

Go to your `Downloads` folder to look for the downloaded data. After unzipping, the downloaded data folder should have a name similar to this: `IHME-GBD_2019_DATA-64c5a7b3-1`. 

If you haven't done it already, create a root folder for all your downloaded GBD data. Let's call this root folder the *GBD folder*. You can create the GBD folder anywhere and name it whatever you like. Store your data folder anywhere in (a subfolder of) this GBD folder. Your GBD folder could be something like: `Users/johnwilliam/datasets/Global Burden of Disease`, with the data folder `Users/johnwilliam/datasets/Global Burden of Disease/IHME-GBD_2019_DATA-64c5a7b3-1`. Pardon my Mac Speak. Just don't change the names of the data files, because `better` searches for them using these names.

## Set global option in your `.Rprofile` file

Enter the path of your GBD folder (e.g., `Users/yourname/datasets/Global Burden of Disease`) as the default GBD path via global options set in your `.Rprofile` file. It will be used by several `better` functions. It is not required, since you can also set global options manually in each session, or even set the path manually for each function call (see below). But it's easier to take care of this once and for all in `.Rprofile`. 

It will look like this:

```{r, eval = FALSE}
options(better.gbd_path = "/Users/yourname/datasets/Global Burden of Disease")
```

If you haven't used `.Rprofile` before, it's a hidden file with code that R runs at startup. It should be located in your home/user folder (e.g., `Users/yourname/.Rprofile`). Learn more about `.Rprofile` on the [Posit Support page](https://support.posit.co/hc/en-us/articles/360047157094-Managing-R-with-Rprofile-Renviron-Rprofile-site-Renviron-site-rsession-conf-and-repos-conf).

For the option you just set in your Rprofile to take effect, you will need to restart R. On restarting, R will read in your Rprofile, with the edited option. (Alternatively, you could manually run the `options(*)` code chunk.)

<!-- end -->

## Beyond the starter dataset

To learn more about using `better`, run `better_vignette(better)` to access the pre-installed HTML vignette. 

```{r, eval = FALSE}
library(better)
?better_vignette
better_vignette(better)
```

Why not just have all of that info in this regular vignette here? Well, the vignette requires some setup (e.g., downloading GBD data). But regular vignettes are built from R code at the time of installation, and thus require everything to already be set up correctly. A pre-installed HTML is more forgiving.

## Thanks

I'd `better` thank some folks: I'd like to thank Jenna Clark for great feedback and ideas!
